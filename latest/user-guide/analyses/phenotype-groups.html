

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Compare genotype and phenotype groups &mdash; GPSEA 0.7.2.dev0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../_static/gpsea.css?v=547657ed" />
      <link rel="stylesheet" type="text/css" href="../../_static/dark_mode_css/general.css?v=c0a7eb24" />
      <link rel="stylesheet" type="text/css" href="../../_static/dark_mode_css/dark.css?v=70edf1c7" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=a2717a26"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../_static/copybutton.js?v=6dbb43f8"></script>
      <script>window.MathJax = {"TeX": {"Macros": {"RR": "{\\mathbb{R}}"}}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      <script src="../../_static/dark_mode_js/default_dark.js?v=fd565c74"></script>
      <script src="../../_static/dark_mode_js/theme_switcher.js?v=358d3910"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Compare phenotype scores in genotype groups" href="phenotype-scores.html" />
    <link rel="prev" title="Statistical analyses" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            GPSEA
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Installation &amp; Tutorial</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial.html">Tutorial</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">User guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../input-data.html">Input data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exploratory.html">Cohort exploratory analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../predicates/index.html">Predicates</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Statistical analyses</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Compare genotype and phenotype groups</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#fisher-exact-test-fet">Fisher exact test (FET)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#example-analysis">Example analysis</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="phenotype-scores.html">Compare phenotype scores in genotype groups</a></li>
<li class="toctree-l3"><a class="reference internal" href="measurements.html">Compare measurement values</a></li>
<li class="toctree-l3"><a class="reference internal" href="survival.html">Survival analysis</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../mtc.html">Multiple-testing correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general_hpo_terms.html">General HPO terms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../glossary.html">Glossary</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../apidocs/modules.html">API reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">GPSEA</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">User guide</a></li>
          <li class="breadcrumb-item"><a href="index.html">Statistical analyses</a></li>
      <li class="breadcrumb-item active">Compare genotype and phenotype groups</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/user-guide/analyses/phenotype-groups.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="compare-genotype-and-phenotype-groups">
<span id="genotype-phenotype-groups"></span><h1>Compare genotype and phenotype groups<a class="headerlink" href="#compare-genotype-and-phenotype-groups" title="Link to this heading"></a></h1>
<section id="fisher-exact-test-fet">
<span id="fisher-exact-test"></span><h2>Fisher exact test (FET)<a class="headerlink" href="#fisher-exact-test-fet" title="Link to this heading"></a></h2>
<p>The Fisher exact test (FET) calculates the exact probability value
for the relationship between two dichotomous variables.
In our implementation, the two dichotomous variables are the genotype and the phenotype.
For instance, the individuals of the cohort may be divided
according to whether or not they have a nonsense variant
and according to whether or not they have Strabismus (<a class="reference external" href="https://hpo.jax.org/browse/term/HP:0000486">HP:0000486</a>).</p>
<p>The results of FET are expressed in terms of an exact probability (P-value), varying within 0 and 1.
Two groups are considered statistically significant if the P-value is less
than the chosen significance level (usually <span class="math notranslate nohighlight">\(\alpha = 0.05\)</span>).</p>
<p>The following graphic shows an example contingency table that is used to conduct a Fisher exact test.
We are comparing the frequency of <em>strabismus</em> in individuals with missense and nonsense variants:</p>
<a class="reference internal image-reference" href="../../_images/fisher.png"><img alt="Fisher exact text example" class="align-center" src="../../_images/fisher.png" style="width: 600px;" />
</a>
<p>To perform the corresponding test in Python, we would use the following code.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">stats</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contingency_table</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span><span class="c1">#   Missense,    Nonsense</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">17</span><span class="p">,</span>          <span class="mi">6</span>       <span class="p">],</span>  <span class="c1"># Strabismus observed</span>
<span class="gp">... </span>   <span class="p">[</span><span class="mi">1</span><span class="p">,</span>          <span class="mi">19</span>       <span class="p">],</span>  <span class="c1"># Strabismus excluded</span>
<span class="gp">... </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">oddsratio</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">fisher_exact</span><span class="p">(</span><span class="n">contingency_table</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">float</span><span class="p">(</span><span class="n">oddsratio</span><span class="p">)</span>
<span class="go">53.833333333333336</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">float</span><span class="p">(</span><span class="n">p_value</span><span class="p">)</span>
<span class="go">5.432292015291845e-06</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">p_value</span></code> evaluates to <cite>5.432292015291845e-06</cite>, meaning there is a significant difference between the groups.</p>
<p>The Fisher exact test evaluates whether the observed frequencies in a contingency table significantly
deviate from the frequencies we would expect if there were no association between the variables.
We want to test whether the frequency of <cite>HP:0000486`</cite> is significantly higher or lower in
one genotype group compared to what would be expected if there were no association.
Note that by default, the <em>two-tailed</em> Fisher exact test is performed, meaning we have no
hypothesis as to whether there is a higher or lower frequency in one of the genotype groups.</p>
<p>However, we are typically interested in testing the associations between the genotype and multiple phenotypic features at once.
GPSEA takes advantage of the HPO structure and simplifies the testing for all HPO terms encoded in the cohort.</p>
</section>
<section id="example-analysis">
<h2>Example analysis<a class="headerlink" href="#example-analysis" title="Link to this heading"></a></h2>
<p>Let’s illustrate this in a real-life example of the analysis of the association between frameshift variants in <em>TBX5</em> gene
and congenital heart defects in the dataset of 156 individuals with mutations in <em>TBX5</em> whose signs and symptoms were
encoded into HPO terms, stored as phenopackets of the <a class="reference external" href="https://pubmed.ncbi.nlm.nih.gov/35705716">GA4GH Phenopacket Schema</a>,
and deposited in <a class="reference external" href="https://github.com/monarch-initiative/phenopacket-store">Phenopacket Store</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The shorter version of the same analysis has been presented in the <a class="reference internal" href="../../tutorial.html#tutorial"><span class="std std-ref">Tutorial</span></a>.</p>
</div>
<section id="load-cohort">
<h3>Load cohort<a class="headerlink" href="#load-cohort" title="Link to this heading"></a></h3>
<p>For the purpose of this analysis, we will load the <a class="reference internal" href="../../apidocs/gpsea.model.html#gpsea.model.Cohort" title="gpsea.model.Cohort"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cohort</span></code></a>
from a <a class="reference external" href="https://github.com/monarch-initiative/gpsea/tree/main/docs/cohort-data/TBX5.0.1.20.json">JSON file</a>.
The cohort was prepared from phenopackets as described in <a class="reference internal" href="../input-data.html#create-cohort-from-phenopackets"><span class="std std-ref">Create a cohort from GA4GH phenopackets</span></a> section,
and then serialized as a JSON file following the instructions in <a class="reference internal" href="../input-data.html#cohort-persistence"><span class="std std-ref">Persist the cohort for later</span></a> section.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">json</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gpsea.io</span> <span class="kn">import</span> <span class="n">GpseaJSONDecoder</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fpath_cohort_json</span> <span class="o">=</span> <span class="s1">&#39;docs/cohort-data/TBX5.0.1.20.json&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fpath_cohort_json</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">cohort</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="n">GpseaJSONDecoder</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">cohort</span><span class="p">)</span>
<span class="go">156</span>
</pre></div>
</div>
</section>
<section id="configure-analysis">
<h3>Configure analysis<a class="headerlink" href="#configure-analysis" title="Link to this heading"></a></h3>
<p>We want to test the association between frameshift <em>TBX5</em> variants and phenotypic abnormalities.
GPSEA exposes a flexible predicate API that lets us create genotype and phenotype predicates
to assign the cohort members into genotype and phenotype categories based on the variants
and the HPO terms. We need to create one genotype predicate and one or more phenotype predicates.</p>
<section id="genotype-predicate">
<h4>Genotype predicate<a class="headerlink" href="#genotype-predicate" title="Link to this heading"></a></h4>
<p>We want to separate the patients into two groups: a group <em>with</em> a frameshift variant
and a group <em>without</em> a frameshift variant (i.e. any other heterozygous variant).
We will use the <em>MANE</em> transcript for the analysis:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tx_id</span> <span class="o">=</span> <span class="s1">&#39;NM_181486.4&#39;</span>
</pre></div>
</div>
<p>Building a genotype predicate is a two step process.
First, we create a <a class="reference internal" href="../../apidocs/gpsea.analysis.predicate.genotype.html#gpsea.analysis.predicate.genotype.VariantPredicate" title="gpsea.analysis.predicate.genotype.VariantPredicate"><code class="xref py py-class docutils literal notranslate"><span class="pre">VariantPredicate</span></code></a>
to test if the variant is predicted to lead to a frameshift in <cite>NM_181486.4</cite>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gpsea.model</span> <span class="kn">import</span> <span class="n">VariantEffect</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gpsea.analysis.predicate.genotype</span> <span class="kn">import</span> <span class="n">VariantPredicates</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_frameshift</span> <span class="o">=</span> <span class="n">VariantPredicates</span><span class="o">.</span><span class="n">variant_effect</span><span class="p">(</span><span class="n">VariantEffect</span><span class="o">.</span><span class="n">FRAMESHIFT_VARIANT</span><span class="p">,</span> <span class="n">tx_id</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_frameshift</span><span class="o">.</span><span class="n">description</span>
<span class="go">&#39;FRAMESHIFT_VARIANT on NM_181486.4&#39;</span>
</pre></div>
</div>
<p>and then we wrap <cite>is_frameshift</cite> in a <a class="reference internal" href="../../apidocs/gpsea.analysis.predicate.genotype.html#gpsea.analysis.predicate.genotype.monoallelic_predicate" title="gpsea.analysis.predicate.genotype.monoallelic_predicate"><code class="xref py py-class docutils literal notranslate"><span class="pre">monoallelic_predicate</span></code></a>
to classify each <em>TBX5</em> cohort member either as an individual with one frameshift allele (<cite>Frameshift</cite>)
or as an idividual with one non-frameshift allele (<cite>Other</cite>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gpsea.analysis.predicate.genotype</span> <span class="kn">import</span> <span class="n">monoallelic_predicate</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt_predicate</span> <span class="o">=</span> <span class="n">monoallelic_predicate</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">a_predicate</span><span class="o">=</span><span class="n">is_frameshift</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">a_label</span><span class="o">=</span><span class="s2">&quot;Frameshift&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">b_label</span><span class="o">=</span><span class="s2">&quot;Other&quot;</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt_predicate</span><span class="o">.</span><span class="n">group_labels</span>
<span class="go">(&#39;Frameshift&#39;, &#39;Other&#39;)</span>
</pre></div>
</div>
<p>In the subsequent analysis, <cite>gt_predicate</cite> will assign a cohort member into the respective group.
Note, any patient with <span class="math notranslate nohighlight">\(0\)</span> or <span class="math notranslate nohighlight">\(\ge 2\)</span> alleles will be <em>omitted</em> from the analysis.</p>
</section>
<section id="phenotype-predicates">
<h4>Phenotype predicates<a class="headerlink" href="#phenotype-predicates" title="Link to this heading"></a></h4>
<p>We recommend testing the genotype phenotype association for all HPO terms that annotate the cohort members,
while taking advantage of the HPO graph structure and of the <a class="reference internal" href="../glossary.html#true-path-rule"><span class="std std-ref">True path rule</span></a>.
We will use the <a class="reference internal" href="../../apidocs/gpsea.analysis.predicate.phenotype.html#gpsea.analysis.predicate.phenotype.prepare_predicates_for_terms_of_interest" title="gpsea.analysis.predicate.phenotype.prepare_predicates_for_terms_of_interest"><code class="xref py py-func docutils literal notranslate"><span class="pre">prepare_predicates_for_terms_of_interest()</span></code></a>
utility function to generate phenotype predicates for all HPO terms.</p>
<p>The function needs HPO to prepare predicates, hence we need to load HPO:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">hpotk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">store</span> <span class="o">=</span> <span class="n">hpotk</span><span class="o">.</span><span class="n">configure_ontology_store</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hpo</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="n">load_minimal_hpo</span><span class="p">(</span><span class="n">release</span><span class="o">=</span><span class="s1">&#39;v2024-07-01&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>and then we can create the predicates</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gpsea.analysis.predicate.phenotype</span> <span class="kn">import</span> <span class="n">prepare_predicates_for_terms_of_interest</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pheno_predicates</span> <span class="o">=</span> <span class="n">prepare_predicates_for_terms_of_interest</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">cohort</span><span class="o">=</span><span class="n">cohort</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">hpo</span><span class="o">=</span><span class="n">hpo</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">pheno_predicates</span><span class="p">)</span>
<span class="go">369</span>
</pre></div>
</div>
<p>The function finds 369 HPO terms that annotate at least one individual,
including the <em>indirect</em> annotations whose presence is implied by the <a class="reference internal" href="../glossary.html#true-path-rule"><span class="std std-ref">True path rule</span></a>.</p>
</section>
<section id="statistical-analysis">
<h4>Statistical analysis<a class="headerlink" href="#statistical-analysis" title="Link to this heading"></a></h4>
<p>We will use <a class="reference internal" href="#fisher-exact-test"><span class="std std-ref">Fisher exact test (FET)</span></a> to test the association
between genotype and phenotype groups, as described previously.</p>
<p>In the case of this cohort, we can test association between having a frameshift variant and one of 369 HPO terms.
However, testing multiple hypotheses on the same dataset increases the risk of finding
a significant association solely by chance.
GPSEA uses a two-pronged strategy to reduce the number of tests and, therefore, mitigate this risk:
a phenotype multiple testing (MT) filter and multiple testing correction (MTC).</p>
<p>Phenotype MT filter selects a (sub)set of HPO terms for testing,
for instance only the user-selected terms (see <code class="xref py py-class docutils literal notranslate"><span class="pre">SpecifyTermsStrategy</span></code>)
or the terms selected by <a class="reference internal" href="../../apidocs/gpsea.analysis.mtc_filter.html#gpsea.analysis.mtc_filter.HpoMtcFilter" title="gpsea.analysis.mtc_filter.HpoMtcFilter"><code class="xref py py-class docutils literal notranslate"><span class="pre">HpoMtcFilter</span></code></a>.</p>
<p>Multiple testing correction then adjusts the nominal p values for the increased risk
of false positive G/P associations.
The available MTC procedures are listed in the <a class="reference internal" href="../mtc.html#mtc-correction-procedures"><span class="std std-ref">Multiple-testing correction procedures</span></a> section.</p>
<p>We must pick one of these to perform genotype-phenotype analysis.</p>
<section id="default-analysis">
<h5>Default analysis<a class="headerlink" href="#default-analysis" title="Link to this heading"></a></h5>
<p>We recommend using HPO MT filter (<a class="reference internal" href="../../apidocs/gpsea.analysis.mtc_filter.html#gpsea.analysis.mtc_filter.HpoMtcFilter" title="gpsea.analysis.mtc_filter.HpoMtcFilter"><code class="xref py py-class docutils literal notranslate"><span class="pre">HpoMtcFilter</span></code></a>) as a phenotype MT filter
and Benjamini-Hochberg for multiple testing correction.
The default analysis can be configured with <a class="reference internal" href="../../apidocs/gpsea.analysis.pcats.html#gpsea.analysis.pcats.configure_hpo_term_analysis" title="gpsea.analysis.pcats.configure_hpo_term_analysis"><code class="xref py py-func docutils literal notranslate"><span class="pre">configure_hpo_term_analysis()</span></code></a> convenience method.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gpsea.analysis.pcats</span> <span class="kn">import</span> <span class="n">configure_hpo_term_analysis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">analysis</span> <span class="o">=</span> <span class="n">configure_hpo_term_analysis</span><span class="p">(</span><span class="n">hpo</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="custom-analysis">
<h5>Custom analysis<a class="headerlink" href="#custom-analysis" title="Link to this heading"></a></h5>
<p>If the defaults do not work, we can configure the analysis manually.
First, we choose a phenotype MT filter (e.g. <a class="reference internal" href="../../apidocs/gpsea.analysis.mtc_filter.html#gpsea.analysis.mtc_filter.HpoMtcFilter" title="gpsea.analysis.mtc_filter.HpoMtcFilter"><code class="xref py py-class docutils literal notranslate"><span class="pre">HpoMtcFilter</span></code></a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gpsea.analysis.mtc_filter</span> <span class="kn">import</span> <span class="n">HpoMtcFilter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mtc_filter</span> <span class="o">=</span> <span class="n">HpoMtcFilter</span><span class="o">.</span><span class="n">default_filter</span><span class="p">(</span><span class="n">hpo</span><span class="p">,</span> <span class="n">term_frequency_threshold</span><span class="o">=</span><span class="mf">.2</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See the <a class="reference internal" href="../mtc.html#mtc-filters"><span class="std std-ref">MT filters: Choosing which terms to test</span></a> section for more info on the available MT filters.</p>
</div>
<p>then a statistical test (e.g. Fisher Exact test):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gpsea.analysis.pcats.stats</span> <span class="kn">import</span> <span class="n">FisherExactTest</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">count_statistic</span> <span class="o">=</span> <span class="n">FisherExactTest</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See the <a class="reference internal" href="../../apidocs/gpsea.analysis.pcats.stats.html#module-gpsea.analysis.pcats.stats" title="gpsea.analysis.pcats.stats"><code class="xref py py-mod docutils literal notranslate"><span class="pre">gpsea.analysis.pcats.stats</span></code></a> module for the available multiple testing procedures
(TL;DR, just Fisher Exact test at this time).</p>
</div>
<p>and we finalize the setup by choosing a MTC procedure
(e.g. <cite>fdr_bh</cite> for Benjamini-Hochberg) along with the MTC alpha:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mtc_correction</span> <span class="o">=</span> <span class="s1">&#39;fdr_bh&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mtc_alpha</span> <span class="o">=</span> <span class="mf">0.05</span>
</pre></div>
</div>
<p>The final <a class="reference internal" href="../../apidocs/gpsea.analysis.pcats.html#gpsea.analysis.pcats.HpoTermAnalysis" title="gpsea.analysis.pcats.HpoTermAnalysis"><code class="xref py py-class docutils literal notranslate"><span class="pre">HpoTermAnalysis</span></code></a> is created as:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gpsea.analysis.pcats</span> <span class="kn">import</span> <span class="n">HpoTermAnalysis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">analysis</span> <span class="o">=</span> <span class="n">HpoTermAnalysis</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">count_statistic</span><span class="o">=</span><span class="n">count_statistic</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">mtc_filter</span><span class="o">=</span><span class="n">mtc_filter</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">mtc_correction</span><span class="o">=</span><span class="s1">&#39;fdr_bh&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">mtc_alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="analysis">
<h3>Analysis<a class="headerlink" href="#analysis" title="Link to this heading"></a></h3>
<p>We can now test associations between the genotype groups and the HPO terms:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">analysis</span><span class="o">.</span><span class="n">compare_genotype_vs_phenotypes</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">cohort</span><span class="o">=</span><span class="n">cohort</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">gt_predicate</span><span class="o">=</span><span class="n">gt_predicate</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">pheno_predicates</span><span class="o">=</span><span class="n">pheno_predicates</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">phenotypes</span><span class="p">)</span>
<span class="go">369</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="o">.</span><span class="n">total_tests</span>
<span class="go">24</span>
</pre></div>
</div>
<p>Thanks to phenotype MT filter, we only tested 24 out of 369 terms.
We can learn more by showing the MT filter report:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gpsea.view</span> <span class="kn">import</span> <span class="n">MtcStatsViewer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mtc_viewer</span> <span class="o">=</span> <span class="n">MtcStatsViewer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mtc_report</span> <span class="o">=</span> <span class="n">mtc_viewer</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mtc_report</span>  
</pre></div>
</div>
<div>
    <style>
        /** Light theme is the default */
        :root {
            --gpsea-color-text: black;
            --gpsea-color-link-text: rgb(0, 118, 187);
            --gpsea-color-link-hover: rgb(0, 99, 156);
            --gpsea-color-primary-a0: #2f5170;
            --gpsea-color-primary-a10: #4778a5;
            --gpsea-color-primary-a20: #5995ce;
            --gpsea-color-primary-a60: LightSkyBlue;
            --gpsea-color-surface-a0: #fcfcfc;
            --gpsea-color-surface-a10: #ffffff;
            --gpsea-color-surface-a20: #b3b3b3;
            --gpsea-color-surface-a30: #8d8d8d;
            --gpsea-color-surface-a40: #646464;
            --gpsea-color-surface-a50: #000000;
        }

        /** Dark theme */
        @media (prefers-color-scheme: dark) {
            :root {
                --gpsea-color-text: rgb(240, 240, 240);
                --gpsea-color-link-text: rgb(240, 240, 240);
                --gpsea-color-link-hover: lightblue;
                --gpsea-color-primary-a0: #64a3df;
                --gpsea-color-primary-a10: #5286b8;
                --gpsea-color-primary-a20: #375c7e;
                --gpsea-color-primary-a60: #233b52;
                --gpsea-color-surface-a0: #121212;
                --gpsea-color-surface-a10: #282828;
                --gpsea-color-surface-a20: #3f3f3f;
                --gpsea-color-surface-a30: #575757;
                --gpsea-color-surface-a40: #717171;
                --gpsea-color-surface-a50: #8b8b8b;
            }

        }

        #gpsea-body {
            max-width: 1600px;
            color: var(--gpsea-color-text);
            background-color: var(--gpsea-color-surface-a0);
        }

        #gpsea-body {

            h1,
            h2,
            h3,
            h4,
            h5 {
                color: var(--gpsea-color-primary-a0);
            }

            a {
                color: var(--gpsea-color-link-text);
                text-decoration: none;
            }

            a:hover {
                color: var(--gpsea-color-link-hover);
            }

            #cohort-summary {
                max-width: 800px;
            }

            td {
                padding: 5px 0;
            }

            .cards {
                display: flex;
                flex-flow: row wrap;
                align-items: top;
                gap: 1rem;
            }

            .card {
                border-radius: 10px;
                padding: 0px 10px;
                background: var(--gpsea-color-surface-a10);
                border: 1px solid var(--gpsea-color-surface-a30);
                box-shadow: 0 4px 8px var(--gpsea-color-surface-a30);
            }

            table {
                width: 100%;
                border-collapse: collapse;
                margin: 10px 0;
                font-size: 0.9em;
                font-family: sans-serif;
                box-shadow: 0 0 20px rgba(0, 0, 0, 0.15);
                border: 1px solid var(--gpsea-color-primary-a60);
            }

            th {
                text-align: left;
                padding: 2px;
                font-weight: bold;
                font-size: 120%;
                color: var(--gpsea-color-text);
                background-color: var(--gpsea-color-primary-a60);
            }

            table td,
            tr {
                text-align: right;
                padding: 0px 5px;
            }

            tr:nth-child(even) {
                background-color: var(--gpsea-color-surface-a10);
            }

            tr:nth-child(odd) {
                background-color: var(--gpsea-color-surface-a20);
            }

            .lft {
                text-align: left;
            }

            caption {
                caption-side: top;
                text-align: left;
                padding-bottom: 10px;
                font-weight: bold;
            }
        }
    </style>
    <div id="gpsea-body">
        
<h1>Phenotype testing report</h1>
<div class="cards">
  <div class="card">
    <ul>
      <li>Phenotype MTC filter: <em>HPO MTC filter</em></li>
      <li>Multiple testing correction: <em>fdr_bh</em></li>
    </ul>
  </div>
  <div class="card">
    <table>
      <tbody>
        <tr>
          <th>Code</th>
          <th>Reason</th>
          <th>Count</th>
        </tr>
        
        <tr>
          <td>HMF01</td>
          <td>Skipping term with maximum frequency that was less than threshold 0.2</td>
          <td>10</td>
        </tr>
        
        <tr>
          <td>HMF08</td>
          <td>Skipping general term</td>
          <td>48</td>
        </tr>
        
        <tr>
          <td>HMF09</td>
          <td>Skipping term with maximum annotation frequency that was less than threshold 0.4</td>
          <td>287</td>
        </tr>
        
      </tbody>
      <caption>
        Performed statistical tests for 24 out of the total of 369 HPO terms.
      </caption>
    </table>
  </div>
</div>

    </div>
</div></section>
<section id="genotype-phenotype-associations">
<h3>Genotype phenotype associations<a class="headerlink" href="#genotype-phenotype-associations" title="Link to this heading"></a></h3>
<p>Last, let’s explore the associations. The results include a table with all tested HPO terms
ordered by the corrected p value (Benjamini-Hochberg FDR):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gpsea.view</span> <span class="kn">import</span> <span class="n">summarize_hpo_analysis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">summary_df</span> <span class="o">=</span> <span class="n">summarize_hpo_analysis</span><span class="p">(</span><span class="n">hpo</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">summary_df</span>  
</pre></div>
</div>
<table class="docutils align-default" id="id1">
<caption><span class="caption-text"><em>TBX5</em> frameshift vs rest</span><a class="headerlink" href="#id1" title="Link to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Allele group</p></th>
<th class="head"><p>Frameshift</p></th>
<th class="head"><p>Frameshift</p></th>
<th class="head"><p>Other</p></th>
<th class="head"><p>Other</p></th>
<th class="head"></th>
<th class="head"></th>
</tr>
<tr class="row-even"><th class="head"></th>
<th class="head"><p>Count</p></th>
<th class="head"><p>Percent</p></th>
<th class="head"><p>Count</p></th>
<th class="head"><p>Percent</p></th>
<th class="head"><p>Corrected p values</p></th>
<th class="head"><p>p values</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>Ventricular septal defect [HP:0001629]</p></td>
<td><p>19/19</p></td>
<td><p>100%</p></td>
<td><p>42/71</p></td>
<td><p>59%</p></td>
<td><p>0.005806240832840839</p></td>
<td><p>0.00024192670136836828</p></td>
</tr>
<tr class="row-even"><td><p>Absent thumb [HP:0009777]</p></td>
<td><p>14/31</p></td>
<td><p>45%</p></td>
<td><p>18/100</p></td>
<td><p>18%</p></td>
<td><p>0.04456405819223913</p></td>
<td><p>0.0037136715160199273</p></td>
</tr>
<tr class="row-odd"><td><p>Secundum atrial septal defect [HP:0001684]</p></td>
<td><p>4/22</p></td>
<td><p>18%</p></td>
<td><p>23/55</p></td>
<td><p>42%</p></td>
<td><p>0.4065940176561687</p></td>
<td><p>0.06544319142266644</p></td>
</tr>
<tr class="row-even"><td><p>Triphalangeal thumb [HP:0001199]</p></td>
<td><p>13/32</p></td>
<td><p>41%</p></td>
<td><p>23/99</p></td>
<td><p>23%</p></td>
<td><p>0.4065940176561687</p></td>
<td><p>0.06932119159387057</p></td>
</tr>
<tr class="row-odd"><td><p>Muscular ventricular septal defect [HP:0011623]</p></td>
<td><p>6/25</p></td>
<td><p>24%</p></td>
<td><p>8/84</p></td>
<td><p>10%</p></td>
<td><p>0.4065940176561687</p></td>
<td><p>0.08470708701170182</p></td>
</tr>
<tr class="row-even"><td><p>Short thumb [HP:0009778]</p></td>
<td><p>8/30</p></td>
<td><p>27%</p></td>
<td><p>25/69</p></td>
<td><p>36%</p></td>
<td><p>1.0</p></td>
<td><p>0.4870099714553749</p></td>
</tr>
<tr class="row-odd"><td><p>Absent radius [HP:0003974]</p></td>
<td><p>6/25</p></td>
<td><p>24%</p></td>
<td><p>9/43</p></td>
<td><p>21%</p></td>
<td><p>1.0</p></td>
<td><p>0.7703831604944444</p></td>
</tr>
<tr class="row-even"><td><p>Atrial septal defect [HP:0001631]</p></td>
<td><p>20/20</p></td>
<td><p>100%</p></td>
<td><p>63/65</p></td>
<td><p>97%</p></td>
<td><p>1.0</p></td>
<td><p>1.0</p></td>
</tr>
<tr class="row-odd"><td><p>Abnormal atrial septum morphology [HP:0011994]</p></td>
<td><p>20/20</p></td>
<td><p>100%</p></td>
<td><p>64/64</p></td>
<td><p>100%</p></td>
<td><p>1.0</p></td>
<td><p>1.0</p></td>
</tr>
<tr class="row-even"><td><p>Abnormal cardiac septum morphology [HP:0001671]</p></td>
<td><p>28/28</p></td>
<td><p>100%</p></td>
<td><p>89/89</p></td>
<td><p>100%</p></td>
<td><p>1.0</p></td>
<td><p>1.0</p></td>
</tr>
<tr class="row-odd"><td><p>Abnormal cardiac atrium morphology [HP:0005120]</p></td>
<td><p>20/20</p></td>
<td><p>100%</p></td>
<td><p>64/64</p></td>
<td><p>100%</p></td>
<td><p>1.0</p></td>
<td><p>1.0</p></td>
</tr>
<tr class="row-even"><td><p>Hypoplasia of the radius [HP:0002984]</p></td>
<td><p>6/14</p></td>
<td><p>43%</p></td>
<td><p>34/75</p></td>
<td><p>45%</p></td>
<td><p>1.0</p></td>
<td><p>1.0</p></td>
</tr>
<tr class="row-odd"><td><p>Abnormal appendicular skeleton morphology [HP:0011844]</p></td>
<td><p>34/34</p></td>
<td><p>100%</p></td>
<td><p>93/93</p></td>
<td><p>100%</p></td>
<td><p>1.0</p></td>
<td><p>1.0</p></td>
</tr>
<tr class="row-even"><td><p>Aplasia/hypoplasia of the extremities [HP:0009815]</p></td>
<td><p>22/22</p></td>
<td><p>100%</p></td>
<td><p>78/78</p></td>
<td><p>100%</p></td>
<td><p>1.0</p></td>
<td><p>1.0</p></td>
</tr>
<tr class="row-odd"><td><p>Aplasia/hypoplasia involving the skeleton [HP:0009115]</p></td>
<td><p>23/23</p></td>
<td><p>100%</p></td>
<td><p>80/80</p></td>
<td><p>100%</p></td>
<td><p>1.0</p></td>
<td><p>1.0</p></td>
</tr>
<tr class="row-even"><td><p>Aplasia/hypoplasia involving bones of the upper limbs [HP:0006496]</p></td>
<td><p>22/22</p></td>
<td><p>100%</p></td>
<td><p>78/78</p></td>
<td><p>100%</p></td>
<td><p>1.0</p></td>
<td><p>1.0</p></td>
</tr>
<tr class="row-odd"><td><p>Aplasia/hypoplasia involving bones of the extremities [HP:0045060]</p></td>
<td><p>22/22</p></td>
<td><p>100%</p></td>
<td><p>78/78</p></td>
<td><p>100%</p></td>
<td><p>1.0</p></td>
<td><p>1.0</p></td>
</tr>
<tr class="row-even"><td><p>Abnormal long bone morphology [HP:0011314]</p></td>
<td><p>13/13</p></td>
<td><p>100%</p></td>
<td><p>50/50</p></td>
<td><p>100%</p></td>
<td><p>1.0</p></td>
<td><p>1.0</p></td>
</tr>
<tr class="row-odd"><td><p>Abnormal hand morphology [HP:0005922]</p></td>
<td><p>20/20</p></td>
<td><p>100%</p></td>
<td><p>75/75</p></td>
<td><p>100%</p></td>
<td><p>1.0</p></td>
<td><p>1.0</p></td>
</tr>
<tr class="row-even"><td><p>Abnormal thumb morphology [HP:0001172]</p></td>
<td><p>31/31</p></td>
<td><p>100%</p></td>
<td><p>58/58</p></td>
<td><p>100%</p></td>
<td><p>1.0</p></td>
<td><p>1.0</p></td>
</tr>
<tr class="row-odd"><td><p>Abnormal finger morphology [HP:0001167]</p></td>
<td><p>31/31</p></td>
<td><p>100%</p></td>
<td><p>64/64</p></td>
<td><p>100%</p></td>
<td><p>1.0</p></td>
<td><p>1.0</p></td>
</tr>
<tr class="row-even"><td><p>Abnormal digit morphology [HP:0011297]</p></td>
<td><p>33/33</p></td>
<td><p>100%</p></td>
<td><p>67/67</p></td>
<td><p>100%</p></td>
<td><p>1.0</p></td>
<td><p>1.0</p></td>
</tr>
<tr class="row-odd"><td><p>Aplasia/Hypoplasia of fingers [HP:0006265]</p></td>
<td><p>19/19</p></td>
<td><p>100%</p></td>
<td><p>44/44</p></td>
<td><p>100%</p></td>
<td><p>1.0</p></td>
<td><p>1.0</p></td>
</tr>
<tr class="row-even"><td><p>Aplasia/hypoplasia involving bones of the hand [HP:0005927]</p></td>
<td><p>19/19</p></td>
<td><p>100%</p></td>
<td><p>44/44</p></td>
<td><p>100%</p></td>
<td><p>1.0</p></td>
<td><p>1.0</p></td>
</tr>
</tbody>
</table>
<p>The table shows that several HPO terms are significantly associated
with presence of a heterozygous (<cite>Frameshift</cite>) frameshift variant in <em>TBX5</em>.
For example, <a class="reference external" href="https://hpo.jax.org/browse/term/HP:0001629">Ventricular septal defect</a>
was observed in 42/71 (59%) patients with no frameshift allele (<cite>Other</cite>)
but it was observed in 19/19 (100%) patients with a frameshift allele (<cite>Frameshift</cite>).
Fisher exact test computed a p value of <cite>~0.000242</cite>
and the p value corrected by Benjamini-Hochberg procedure
is <cite>~0.005806</cite>.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Statistical analyses" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="phenotype-scores.html" class="btn btn-neutral float-right" title="Compare phenotype scores in genotype groups" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>